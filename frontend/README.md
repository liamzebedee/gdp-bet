# Frontend - USGDP.Q3.2025

Next.js application for the GDP prediction market MVP.

## Architecture

**Stack:** Next.js 15 + React 19 + ethers v5 + RainbowKit + Tailwind CSS

**Key Design Decisions:**
- No wagmi/viem (per spec requirement)
- Direct RPC calls via ethers v5
- No backend or subgraph dependencies
- Single-page application with multiple panels

## Project Structure

```
frontend/
├── app/
│   ├── layout.tsx          # Root layout with providers
│   ├── page.tsx            # Main trading interface
│   └── providers.tsx       # RainbowKit/ethers setup
├── contracts.js            # Auto-generated contract ABIs and addresses
└── public/                 # Static assets
```

## Development

```bash
# Install dependencies
npm install

# Start development server
npm run dev

# Build for production  
npm run build
npm run start
```

## Core Components

### Main Trading Interface
- **Top Bar**: Network status, wallet connection, market label, countdown timer
- **Vault Panel**: TVL, user balances, estimated payouts
- **Mint Panel**: Choose side (L/S), amount input, fee display, approve/mint flow
- **Pair Redeem Panel**: Burn equal L+S tokens for USDC (Open phase only)
- **Redeem Panel**: Single-sided redemption (Settled phase only)
- **Prices Panel**: Uniswap v3 pool prices and TVL, trade links
- **Oracle Panel**: GDP data and finalization status

### Contract Integration

**Contract Addresses & ABIs:**
- Imported from `contracts.js` (auto-generated by deployment script)
- Market contract, Long/Short tokens, Oracle, USDC

**Phase Detection:**
```javascript
// Determine current phase from timestamps and oracle status
const now = Date.now() / 1000;
if (now < openAt) return 'Pending';
if (now < closeAt) return 'Open'; 
if (!oracleFinalized) return 'Frozen';
return 'Settled';
```

**Error Handling:**
- Precise error messages for each failure case
- Phase-specific button disabling
- Balance and allowance validation

### Uniswap Price Integration

**Price Calculation:**
```javascript
// Read slot0 from Uniswap v3 pool
const { tick } = await pool.slot0();
const price = 1.0001 ** tick; // Convert tick to price ratio
```

**Pool Addresses:**
- L/USDC: 0.3% fee tier
- S/USDC: 0.3% fee tier

### State Management

**Real-time Updates:**
- Periodic RPC polling for contract state
- Event listening for user transactions
- Automatic refresh on wallet/network changes

**Local State:**
- User inputs and form validation
- Loading states for async operations
- Error messages and success feedback

## Configuration

**Environment Variables:**
```
NEXT_PUBLIC_RPC_URL=        # Ethereum RPC endpoint
NEXT_PUBLIC_CHAIN_ID=       # Target chain ID
```

**Contract Configuration:**
Set in `contracts.js` by deployment script.

## User Experience

**Responsive Design:**
- Mobile-friendly layout
- Clear visual hierarchy
- Accessibility standards

**Performance:**
- Minimal external dependencies
- Optimistic UI updates
- Efficient RPC batching where possible

## Deployment

**Static Export:**
```bash
npm run build
# Deploy build/ folder to CDN/hosting
```

**Environment Setup:**
- Configure RPC endpoints
- Verify contract addresses
- Test wallet connections

## Testing

**Manual Testing Checklist:**
- [ ] Wallet connection flow
- [ ] All trading phases work correctly
- [ ] Error states display properly
- [ ] Uniswap price data loads
- [ ] Oracle status updates
- [ ] Mobile responsiveness

**Integration Testing:**
Test against deployed contracts on testnet before mainnet launch.
